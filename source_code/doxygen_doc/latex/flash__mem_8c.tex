\hypertarget{flash__mem_8c}{\section{C\-:/\-Users/limpkin/\-Dropbox/\-Projets/mooltipass/source\-\_\-code/src/\-F\-L\-A\-S\-H/flash\-\_\-mem.c File Reference}
\label{flash__mem_8c}\index{C\-:/\-Users/limpkin/\-Dropbox/\-Projets/mooltipass/source\-\_\-code/src/\-F\-L\-A\-S\-H/flash\-\_\-mem.\-c@{C\-:/\-Users/limpkin/\-Dropbox/\-Projets/mooltipass/source\-\_\-code/src/\-F\-L\-A\-S\-H/flash\-\_\-mem.\-c}}
}


Flash memory low level functions Copyright \mbox{[}2014\mbox{]} \mbox{[}Mathieu Stephan\mbox{]}.  


{\ttfamily \#include \char`\"{}../mooltipass.\-h\char`\"{}}\\*
{\ttfamily \#include $<$avr/io.\-h$>$}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{flash__mem_8c_affd5147b64d2ee3bbc74e6c940683c6e}{send\-Data\-To\-Flash} (uint8\-\_\-t nb\-\_\-bytes\-\_\-opcode, uint8\-\_\-t $\ast$opcode, uint16\-\_\-t nb\-\_\-bytes, uint8\-\_\-t $\ast$data\-\_\-to\-\_\-send\-\_\-receive)
\begin{DoxyCompactList}\small\item\em Send bytes to the flash memory... beware, buffer contents will be changed! \end{DoxyCompactList}\item 
void \hyperlink{flash__mem_8c_a943bf471830f72ec542d5b37ae030160}{read\-Credential\-Block} (uint16\-\_\-t page\-\_\-number, uint8\-\_\-t block\-\_\-id, uint8\-\_\-t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Read a block of credentials. \end{DoxyCompactList}\item 
\hypertarget{flash__mem_8c_a1e8a5c9034044f422af36e4033deeb65}{void \hyperlink{flash__mem_8c_a1e8a5c9034044f422af36e4033deeb65}{wait\-For\-Flash} (void)}\label{flash__mem_8c_a1e8a5c9034044f422af36e4033deeb65}

\begin{DoxyCompactList}\small\item\em Wait for the flash to be ready. \end{DoxyCompactList}\item 
void \hyperlink{flash__mem_8c_a3af3151e4e79e82e5daec836a16ec607}{write\-Credential\-Block} (uint16\-\_\-t page\-\_\-number, uint8\-\_\-t block\-\_\-id, uint8\-\_\-t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Write a block of credentials. \end{DoxyCompactList}\item 
R\-E\-T\-\_\-\-T\-Y\-P\-E \hyperlink{flash__mem_8c_a80d6fcc1bf2a1dbdc4f6462cac22c219}{check\-Flash\-I\-D} (void)
\begin{DoxyCompactList}\small\item\em Check the presence of the flash. \end{DoxyCompactList}\item 
R\-E\-T\-\_\-\-T\-Y\-P\-E \hyperlink{flash__mem_8c_a555b58a0dfede24e6ed8b169b24ffc64}{init\-Flash} (void)
\begin{DoxyCompactList}\small\item\em Initialize the flash memory. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Flash memory low level functions Copyright \mbox{[}2014\mbox{]} \mbox{[}Mathieu Stephan\mbox{]}. 

\subsection{Function Documentation}
\hypertarget{flash__mem_8c_a80d6fcc1bf2a1dbdc4f6462cac22c219}{\index{flash\-\_\-mem.\-c@{flash\-\_\-mem.\-c}!check\-Flash\-I\-D@{check\-Flash\-I\-D}}
\index{check\-Flash\-I\-D@{check\-Flash\-I\-D}!flash_mem.c@{flash\-\_\-mem.\-c}}
\subsubsection[{check\-Flash\-I\-D}]{\setlength{\rightskip}{0pt plus 5cm}check\-Flash\-I\-D (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{flash__mem_8c_a80d6fcc1bf2a1dbdc4f6462cac22c219}


Check the presence of the flash. 

\begin{DoxyReturn}{Returns}
Success status 
\end{DoxyReturn}
\hypertarget{flash__mem_8c_a555b58a0dfede24e6ed8b169b24ffc64}{\index{flash\-\_\-mem.\-c@{flash\-\_\-mem.\-c}!init\-Flash@{init\-Flash}}
\index{init\-Flash@{init\-Flash}!flash_mem.c@{flash\-\_\-mem.\-c}}
\subsubsection[{init\-Flash}]{\setlength{\rightskip}{0pt plus 5cm}init\-Flash (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{flash__mem_8c_a555b58a0dfede24e6ed8b169b24ffc64}


Initialize the flash memory. 

\begin{DoxyReturn}{Returns}
Success status\-D\-D 
\end{DoxyReturn}
\hypertarget{flash__mem_8c_a943bf471830f72ec542d5b37ae030160}{\index{flash\-\_\-mem.\-c@{flash\-\_\-mem.\-c}!read\-Credential\-Block@{read\-Credential\-Block}}
\index{read\-Credential\-Block@{read\-Credential\-Block}!flash_mem.c@{flash\-\_\-mem.\-c}}
\subsubsection[{read\-Credential\-Block}]{\setlength{\rightskip}{0pt plus 5cm}read\-Credential\-Block (
\begin{DoxyParamCaption}
\item[{uint16\-\_\-t}]{page\-\_\-number, }
\item[{uint8\-\_\-t}]{block\-\_\-id, }
\item[{uint8\-\_\-t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}}\label{flash__mem_8c_a943bf471830f72ec542d5b37ae030160}


Read a block of credentials. 


\begin{DoxyParams}{Parameters}
{\em page\-\_\-number} & Page number in the flash \\
\hline
{\em block\-\_\-id} & The block I\-D in the page \\
\hline
{\em buffer} & Pointer to the buffer \\
\hline
\end{DoxyParams}
\hypertarget{flash__mem_8c_affd5147b64d2ee3bbc74e6c940683c6e}{\index{flash\-\_\-mem.\-c@{flash\-\_\-mem.\-c}!send\-Data\-To\-Flash@{send\-Data\-To\-Flash}}
\index{send\-Data\-To\-Flash@{send\-Data\-To\-Flash}!flash_mem.c@{flash\-\_\-mem.\-c}}
\subsubsection[{send\-Data\-To\-Flash}]{\setlength{\rightskip}{0pt plus 5cm}send\-Data\-To\-Flash (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{nb\-\_\-bytes\-\_\-opcode, }
\item[{uint8\-\_\-t $\ast$}]{opcode, }
\item[{uint16\-\_\-t}]{nb\-\_\-bytes, }
\item[{uint8\-\_\-t $\ast$}]{data\-\_\-to\-\_\-send\-\_\-receive}
\end{DoxyParamCaption}
)}}\label{flash__mem_8c_affd5147b64d2ee3bbc74e6c940683c6e}


Send bytes to the flash memory... beware, buffer contents will be changed! 


\begin{DoxyParams}{Parameters}
{\em nb\-\_\-bytes\-\_\-opcode} & The number of bytes for the opcode \\
\hline
{\em opcode} & Pointer to the opcode \\
\hline
{\em nb\-\_\-bytes} & The number of bytes \\
\hline
{\em data\-\_\-to\-\_\-send\-\_\-receive} & Pointer to the buffer \\
\hline
\end{DoxyParams}
\hypertarget{flash__mem_8c_a3af3151e4e79e82e5daec836a16ec607}{\index{flash\-\_\-mem.\-c@{flash\-\_\-mem.\-c}!write\-Credential\-Block@{write\-Credential\-Block}}
\index{write\-Credential\-Block@{write\-Credential\-Block}!flash_mem.c@{flash\-\_\-mem.\-c}}
\subsubsection[{write\-Credential\-Block}]{\setlength{\rightskip}{0pt plus 5cm}write\-Credential\-Block (
\begin{DoxyParamCaption}
\item[{uint16\-\_\-t}]{page\-\_\-number, }
\item[{uint8\-\_\-t}]{block\-\_\-id, }
\item[{uint8\-\_\-t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}}\label{flash__mem_8c_a3af3151e4e79e82e5daec836a16ec607}


Write a block of credentials. 


\begin{DoxyParams}{Parameters}
{\em page\-\_\-number} & Page number in the flash \\
\hline
{\em block\-\_\-id} & The block I\-D in the page \\
\hline
{\em buffer} & Pointer to the buffer \\
\hline
\end{DoxyParams}
