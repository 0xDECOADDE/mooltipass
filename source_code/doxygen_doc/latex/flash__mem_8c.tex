\hypertarget{flash__mem_8c}{\section{C\+:/\+Users/limpkin/\+Dropbox/\+Projets/mooltipass/source\+\_\+code/src/\+F\+L\+A\+S\+H/flash\+\_\+mem.c File Reference}
\label{flash__mem_8c}\index{C\+:/\+Users/limpkin/\+Dropbox/\+Projets/mooltipass/source\+\_\+code/src/\+F\+L\+A\+S\+H/flash\+\_\+mem.\+c@{C\+:/\+Users/limpkin/\+Dropbox/\+Projets/mooltipass/source\+\_\+code/src/\+F\+L\+A\+S\+H/flash\+\_\+mem.\+c}}
}


Mooltipass Flash I\+C Library Created\+: 31/3/2014 Author\+: Michael Neiderhauser.  


{\ttfamily \#include \char`\"{}flash\+\_\+mem.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}defines.\+h\char`\"{}}\\*
{\ttfamily \#include $<$avr/io.\+h$>$}\\*
{\ttfamily \#include $<$stdint.\+h$>$}\\*
{\ttfamily \#include $<$spi.\+h$>$}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{flash__mem_8c_aa58e16776fe4909cffdcd269c30383bc}{R\+E\+T\+\_\+\+T\+Y\+P\+E {\bfseries send\+Data\+To\+Flash} (uint8\+\_\+t opcode\+Size, void $\ast$opcode, uint16\+\_\+t buffer\+Size, void $\ast$buffer)}\label{flash__mem_8c_aa58e16776fe4909cffdcd269c30383bc}

\item 
R\+E\+T\+\_\+\+T\+Y\+P\+E \hyperlink{flash__mem_8c_a1e8a5c9034044f422af36e4033deeb65}{wait\+For\+Flash} (void)
\begin{DoxyCompactList}\small\item\em Wait for the flash to be ready (poll status register) \end{DoxyCompactList}\item 
R\+E\+T\+\_\+\+T\+Y\+P\+E \hyperlink{flash__mem_8c_a80d6fcc1bf2a1dbdc4f6462cac22c219}{check\+Flash\+I\+D} (void)
\begin{DoxyCompactList}\small\item\em Check the presence of the flash (manf info) \end{DoxyCompactList}\item 
R\+E\+T\+\_\+\+T\+Y\+P\+E \hyperlink{flash__mem_8c_a555b58a0dfede24e6ed8b169b24ffc64}{init\+Flash} (void)
\begin{DoxyCompactList}\small\item\em Initialize the flash memory (Sets up S\+P\+I) \end{DoxyCompactList}\item 
R\+E\+T\+\_\+\+T\+Y\+P\+E \hyperlink{flash__mem_8c_a5c3e6a183eb517d31fd9f5a3c7aca486}{sector\+Zero\+Erase} (uint8\+\_\+t sector\+Number)
\begin{DoxyCompactList}\small\item\em Deletes sub-\/section of sector 0\+X (see datasheet) \end{DoxyCompactList}\item 
\hypertarget{flash__mem_8c_a2077f00817a9a75b9c20056fcdb388ce}{R\+E\+T\+\_\+\+T\+Y\+P\+E {\bfseries sector\+Erase} (uint8\+\_\+t sector\+Number)}\label{flash__mem_8c_a2077f00817a9a75b9c20056fcdb388ce}

\item 
R\+E\+T\+\_\+\+T\+Y\+P\+E \hyperlink{flash__mem_8c_a6fc8592cb75ed97e2fd999031e33060f}{block\+Erase} (uint16\+\_\+t block\+Number)
\begin{DoxyCompactList}\small\item\em Erases a block of flash memory (see datasheet) \end{DoxyCompactList}\item 
R\+E\+T\+\_\+\+T\+Y\+P\+E \hyperlink{flash__mem_8c_ab94e1181e052b66db48980b21504f39b}{page\+Erase} (uint16\+\_\+t page\+Number)
\begin{DoxyCompactList}\small\item\em Erases a page of flash memory (see datasheet) \end{DoxyCompactList}\item 
\hypertarget{flash__mem_8c_a4386898d9384e4a0f4252e87dda60ddc}{R\+E\+T\+\_\+\+T\+Y\+P\+E {\bfseries write\+Data\+To\+Flash} (uint16\+\_\+t page\+Number, uint16\+\_\+t offset, uint16\+\_\+t data\+Size, void $\ast$data)}\label{flash__mem_8c_a4386898d9384e4a0f4252e87dda60ddc}

\item 
\hypertarget{flash__mem_8c_a564706fa7a89ff4c63f1da38033865ac}{R\+E\+T\+\_\+\+T\+Y\+P\+E {\bfseries read\+Data\+From\+Flash} (uint16\+\_\+t page\+Number, uint16\+\_\+t offset, uint16\+\_\+t data\+Size, void $\ast$data)}\label{flash__mem_8c_a564706fa7a89ff4c63f1da38033865ac}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
Mooltipass Flash I\+C Library Created\+: 31/3/2014 Author\+: Michael Neiderhauser. 



\subsection{Function Documentation}
\hypertarget{flash__mem_8c_a6fc8592cb75ed97e2fd999031e33060f}{\index{flash\+\_\+mem.\+c@{flash\+\_\+mem.\+c}!block\+Erase@{block\+Erase}}
\index{block\+Erase@{block\+Erase}!flash\+\_\+mem.\+c@{flash\+\_\+mem.\+c}}
\subsubsection[{block\+Erase}]{\setlength{\rightskip}{0pt plus 5cm}block\+Erase (
\begin{DoxyParamCaption}
\item[{uint16\+\_\+t}]{block\+Number}
\end{DoxyParamCaption}
)}}\label{flash__mem_8c_a6fc8592cb75ed97e2fd999031e33060f}


Erases a block of flash memory (see datasheet) 


\begin{DoxyParams}{Parameters}
{\em block\+Number} & The block number in flash to erase \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Success status. Will return R\+E\+T\+U\+R\+N\+\_\+\+N\+O\+K if parameters are out of range. Otherwise will return R\+E\+T\+U\+R\+N\+\_\+\+O\+K. 
\end{DoxyReturn}
\hypertarget{flash__mem_8c_a80d6fcc1bf2a1dbdc4f6462cac22c219}{\index{flash\+\_\+mem.\+c@{flash\+\_\+mem.\+c}!check\+Flash\+I\+D@{check\+Flash\+I\+D}}
\index{check\+Flash\+I\+D@{check\+Flash\+I\+D}!flash\+\_\+mem.\+c@{flash\+\_\+mem.\+c}}
\subsubsection[{check\+Flash\+I\+D}]{\setlength{\rightskip}{0pt plus 5cm}check\+Flash\+I\+D (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{flash__mem_8c_a80d6fcc1bf2a1dbdc4f6462cac22c219}


Check the presence of the flash (manf info) 

\begin{DoxyReturn}{Returns}
Success status 
\end{DoxyReturn}
\hypertarget{flash__mem_8c_a555b58a0dfede24e6ed8b169b24ffc64}{\index{flash\+\_\+mem.\+c@{flash\+\_\+mem.\+c}!init\+Flash@{init\+Flash}}
\index{init\+Flash@{init\+Flash}!flash\+\_\+mem.\+c@{flash\+\_\+mem.\+c}}
\subsubsection[{init\+Flash}]{\setlength{\rightskip}{0pt plus 5cm}init\+Flash (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{flash__mem_8c_a555b58a0dfede24e6ed8b169b24ffc64}


Initialize the flash memory (Sets up S\+P\+I) 

\begin{DoxyReturn}{Returns}
Success status\+D\+D 
\end{DoxyReturn}
\hypertarget{flash__mem_8c_ab94e1181e052b66db48980b21504f39b}{\index{flash\+\_\+mem.\+c@{flash\+\_\+mem.\+c}!page\+Erase@{page\+Erase}}
\index{page\+Erase@{page\+Erase}!flash\+\_\+mem.\+c@{flash\+\_\+mem.\+c}}
\subsubsection[{page\+Erase}]{\setlength{\rightskip}{0pt plus 5cm}page\+Erase (
\begin{DoxyParamCaption}
\item[{uint16\+\_\+t}]{page\+Number}
\end{DoxyParamCaption}
)}}\label{flash__mem_8c_ab94e1181e052b66db48980b21504f39b}


Erases a page of flash memory (see datasheet) 


\begin{DoxyParams}{Parameters}
{\em page\+Number} & The page number if flash to erase \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Success status. Will return R\+E\+T\+U\+R\+N\+\_\+\+N\+O\+K if parameters are out of range. Otherwise will return R\+E\+T\+U\+R\+N\+\_\+\+O\+K. 
\end{DoxyReturn}
\hypertarget{flash__mem_8c_a5c3e6a183eb517d31fd9f5a3c7aca486}{\index{flash\+\_\+mem.\+c@{flash\+\_\+mem.\+c}!sector\+Zero\+Erase@{sector\+Zero\+Erase}}
\index{sector\+Zero\+Erase@{sector\+Zero\+Erase}!flash\+\_\+mem.\+c@{flash\+\_\+mem.\+c}}
\subsubsection[{sector\+Zero\+Erase}]{\setlength{\rightskip}{0pt plus 5cm}sector\+Zero\+Erase (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{sector\+Number}
\end{DoxyParamCaption}
)}}\label{flash__mem_8c_a5c3e6a183eb517d31fd9f5a3c7aca486}


Deletes sub-\/section of sector 0\+X (see datasheet) 


\begin{DoxyParams}{Parameters}
{\em sector\+Number} & The sub-\/section of sector 0 to erase (0 for 0a, 1 for 0b) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Success status. Will return R\+E\+T\+U\+R\+N\+\_\+\+N\+O\+K if sector\+Number is not 0 or 1 
\end{DoxyReturn}
\hypertarget{flash__mem_8c_a1e8a5c9034044f422af36e4033deeb65}{\index{flash\+\_\+mem.\+c@{flash\+\_\+mem.\+c}!wait\+For\+Flash@{wait\+For\+Flash}}
\index{wait\+For\+Flash@{wait\+For\+Flash}!flash\+\_\+mem.\+c@{flash\+\_\+mem.\+c}}
\subsubsection[{wait\+For\+Flash}]{\setlength{\rightskip}{0pt plus 5cm}wait\+For\+Flash (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{flash__mem_8c_a1e8a5c9034044f422af36e4033deeb65}


Wait for the flash to be ready (poll status register) 

\begin{DoxyReturn}{Returns}
Success status 
\end{DoxyReturn}
